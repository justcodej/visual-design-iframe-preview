"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.send = exports.get = void 0;
var _commonLib = require("@boluome/common-lib");
var _antdMobileV = require("antd-mobile-v5");
var _const = require("./const");
var getDomainName = function getDomainName(appCode) {
  if (appCode === void 0) {
    appCode = _const.defaultAppCode;
  }
  if (/192.168.|localhost|0.0.0.0|dev-|test-/.test(location.hostname)) {
    return "https://dev-" + appCode + ".otosaas.com";
  }
  if (/view.otosaas.com/.test(location.hostname)) {
    return "https://" + appCode + ".otosaas.com";
  }
  return location.origin;
};
var send = function send(_ref) {
  var _ref$appCode = _ref.appCode,
    appCode = _ref$appCode === void 0 ? _const.defaultAppCode : _ref$appCode,
    url = _ref.url,
    _ref$type = _ref.type,
    type = _ref$type === void 0 ? null : _ref$type,
    data = _ref.data;
  console.log('appCode, url, type = null, data', appCode, url, type, data);
  var sid = (0, _commonLib.getStore)('customerUserId', 'session') || 'no-sid';
  var expiration = (0, _commonLib.getStore)('expiration', 'session') || '';
  return new Promise(function (resolve, reject) {
    (0, _commonLib.send)(getDomainName(appCode) + url, data, type || {
      sid: sid,
      expiration: expiration
    }).then(function (res) {
      return resolve(res);
    })["catch"](function (err) {
      _antdMobileV.Toast.show('请求失败!');
      reject(err);
    });
  });
};
exports.send = send;
var get = function get(_ref2) {
  var appCode = _ref2.appCode,
    url = _ref2.url,
    _ref2$data = _ref2.data,
    data = _ref2$data === void 0 ? {} : _ref2$data;
  var sid = (0, _commonLib.getStore)('customerUserId', 'session') || 'no-sid';
  var expiration = (0, _commonLib.getStore)('expiration', 'session') || '';
  return new Promise(function (resolve, reject) {
    (0, _commonLib.get)(getDomainName(appCode) + url, data, {
      sid: sid,
      expiration: expiration
    }).then(function (res) {
      return resolve(res);
    })["catch"](function (err) {
      _antdMobileV.Toast.show('请求失败!');
      reject(err);
    });
  });
};
exports.get = get;